<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Green Line’s Breaking Point</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* General Styles */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            color: #fff;
            background: #008000;
        }

        h1 {
            font-size: 3rem;
            text-align: center;
            padding: 20px 20px 0;
            color: #fff;
            font-weight: 600;
        }

        p {
            font-size: 1.25rem;
            line-height: 1.8;
            text-align: center;
        }

        /* Fullscreen Section for Parallax Effect */
        .parallax {
            position: relative;
            min-height: 100vh;
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .text-box {
            background: rgba(255, 255, 255, 0.9);
            color: #000;
            max-width: 800px;
            margin: 20px auto;
            padding: 30px;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        img {
            max-width: 100%;
            display: block;
            margin: 20px auto;
            border-radius: 10px;
        }

        /* Heatmap Grid Container */
        .heatmap-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Two heatmaps per row */
            gap: 20px; /* Space between heatmaps */
            padding: 20px;
        }

        /* Individual Heatmap Styling */
        .heatmap iframe {
            width: 100%;
            height: 600px; /* Larger size for visibility */
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        /* Bar chart container */
        #chart-container {
            width: 80%;
            margin: 50px auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #chart {
            height: 400px;
        }
    </style>
    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>

    <h1>The Green Line’s Breaking Point: What September Reveals About Boston’s Transit Failures</h1>

    <!-- Section 1 -->
    <div class="parallax" id="section1">
        <div class="text-box">
            <p>Rush hour on the Green Line is a Bostonian’s definition of frustration. At Prudential, the platform crowds with commuters, students, and shoppers as another two-car train pulls in. To no one's surprise, it’s already packed to capacity. A few determined riders squeeze on, but the rest wait, hoping the next train will hopefully have space.</p>
        </div>
    </div>

     <!-- Section 2 -->
    <div class="parallax" id="section2">
        <div class="text-box">
            <p>According to data from the MBTA about gated entries, in September 2024, over 1.5 million passengers entered gated Green Line stations, a surge driven by returning students and a revitalized post-pandemic city. A gated entry is recorded when a passenger taps their card or pays a fare at an underground station. But these numbers tell only part of the story. Above-ground stops, particularly on the B, C, and E Lines, rely on onboard fare collection, meaning untapped entries aren’t counted, bringing the number to well over 1.5 million.</p>
        </div>
    </div>

 <div id="chart-container">
        <h2>Total Amount of Gated Entries Per Month</h2>
        <svg id="chart"></svg>
        <p class="caption">Data source: MBTA</p>
    </div>

    <script>
        // Data for the chart
        const data = [
            { month: "June", entries: 1496572 },
            { month: "July", entries: 1377880 },
            { month: "August", entries: 1459179 },
            { month: "September", entries: 1572163 }
        ];

        const margin = { top: 20, right: 30, bottom: 50, left: 80 };
        const width = 800 - margin.left - margin.right;
        const height = 400 - margin.top - margin.bottom;

        const svg = d3.select("#chart")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const x = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.entries) * 1.1])
            .range([0, width]);

        const y = d3.scaleBand()
            .domain(data.map(d => d.month))
            .range([0, height])
            .padding(0.1);

        svg.append("g")
            .call(d3.axisLeft(y));

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).ticks(5).tickFormat(d3.format(",")).tickSizeOuter(0));

        svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("y", d => y(d.month))
            .attr("height", y.bandwidth())
            .attr("x", 0)
            .attr("width", 0) // Start with 0 width for animation
            .style("fill", "#4CAF50")
            .transition()
            .duration(1000)
            .attr("width", d => x(d.entries));

        svg.selectAll(".value")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "value")
            .attr("x", d => x(d.entries) - 10)
            .attr("y", d => y(d.month) + y.bandwidth() / 2)
            .attr("dy", ".35em")
            .text(d => d.entries.toLocaleString())
            .style("font-size", "12px")
            .style("fill", "white")
            .style("text-anchor", "end");
    </script>
    
    <!-- Section 3 -->
    <div class="parallax" id="section3">
        <div class="text-box">
            <p>Moreover, the MBTA’s gated entry data removes an estimated number of riders who transfer to the Red Line at Park Street, the Blue Line at Government Center, and other intersecting lines. This filtering is meant to clarify Green Line-specific ridership, but it also risks underestimating the true load on the system.</p>
        </div>
    </div>

    <!-- Section 4 -->
    <div class="parallax" id="section4">
        <div class="text-box">
            <p>On average the green line operates with a train coming every 7-8 minutes. Interestingly enough, when looking at the times trains came into each station, the averge wait time for a green line train did not change during rush hour. See the heatmaps below for the average wait at each station, depending on the hour, with the dark green indicating less of a wait time, and the lighter indicatig more of a wait time.</p>
        </div>

     <div class="heatmap-container">
        <div>
            <h2>Heatmap Group 1</h2>
            <iframe src="heatmap_group1.html"></iframe>
        </div>
        <div>
            <h2>Heatmap Group 2</h2>
            <iframe src="heatmap_group2.html"></iframe>
        </div>
        <div>
            <h2>Heatmap Group 3</h2>
            <iframe src="heatmap_group3.html"></iframe>
        </div>
        <div>
            <h2>Heatmap Group 4</h2>
            <iframe src="heatmap_group4.html"></iframe>
        </div>
    </div>

    <!-- Section 5 -->
    <div class="parallax" id="section5">
        <div class="text-box">
            <p>The data reveals a critical failure of the Green Line during rush hours: train frequencies remain nearly unchanged from off-peak periods. On average, trains arrive every 8 to 9 minutes, even during the busiest morning (7:00–9:00 AM) and evening (4:00–6:00 PM) peaks. For a transit system tasked with absorbing predictable demand surges, this stagnation results in overcrowded platforms and delayed commutes.</p>
        </div>
    </div>

    <!-- Section 6 -->
    <div class="parallax" id="section5">
        <div class="text-box">
            <p>It is also importat to note that stations like copley, arlington, and north station have multiple lines (B,C,D,E) that travel through the station, so these times do not accurately reflect the time you would be waiting depending on where you are going. This screengrab taken right from the MBTA website, shows that all green line trains had the lowest perecntages of accuracy ratings. </p>
        </div>
    </div>

    <!-- Section 7 -->
    <div class="parallax" id="section6">
        <div class="text-box">
            <p> The MBTA says: "We consider a prediction to be accurate when a train or bus arrives within minutes of a prediction. The exact number of minutes depends on how far out into the future a prediction is."</p>
        </div>
    </div>

    <!-- Section 8 -->
    <div class="parallax" id="section7">
        <div class="text-box">
            <p>Even as the data reveals critical flaws, it also highlights the limitations of the MBTA’s current metrics. Above-ground stops on the B, C, and E Lines are unmeasured due to outdated onboard payment systems. Additionally, gated entries represent only passengers entering the Green Line system—they do not account for direction. Approximately half of these riders are traveling eastbound (inbound) and the other half westbound (outbound).</p>
        </div>
    </div>

    <!-- Section 9 -->
    <div class="parallax" id="section8">
        <div class="text-box">
            <p>The Green Line’s failures aren’t just inconveniences; they represent systemic risks for Boston. Transit inefficiencies increase commute times, disrupt productivity, and discourage public transit use, pushing more people into cars. This exacerbates traffic congestion, worsens air quality, and undermines the city’s climate goals.</p>
        </div>
    </div>

    <!-- Section 10 -->
    <div class="parallax" id="section9">
        <div class="text-box">
            <p>These challenges are solvable but urgent. Increasing train frequency during rush hours, modernizing fare collection to capture untapped ridership, and addressing infrastructure delays would dramatically improve service.</p>
        </div>
    </div>

    
    <!-- Section 11: Background Image with Visible Picture and Text Scrolls Up -->
    <div class="background-section" style="background-image: url('https://raw.githubusercontent.com/mcmosso/mbta-project/main/GL-Option-3-1.jpg');">
        <div class="text-box">
            <p>The MBTA has promised relief in the form of sleek new Green Line trains, set to debut by 2027, with larger cars capable of carrying nearly 300 passengers each. These updates are being hailed as a long-overdue fix to an overcrowded system. However, for riders who’ve endured years of delays and stagnant service, it is fair to feel excitement mixed with warranted skepticism.</p>
        </div>
    </div>

    <!-- Section 12 -->
    <div class="parallax" id="section10">
        <div class="text-box">
            <p>If Boston is serious about being a modern, sustainable city, its transit system must evolve. The Green Line, steeped in history, must become a part of Boston’s future, not a relic of its past.</p>
        </div>
    </div>

    <script>
        function handleScroll() {
            const textBoxes = document.querySelectorAll('.text-box');
            textBoxes.forEach(box => {
                const boxTop = box.getBoundingClientRect().top;
                const windowHeight = window.innerHeight;

                // Reveal the text box when it's near the middle of the screen
                if (boxTop < windowHeight - 300) {
                    box.classList.add('visible');
                } else {
                    box.classList.remove('visible');
                }
            });
        }

        window.addEventListener('scroll', handleScroll);
        handleScroll();
    </script>

</body>
</html>
